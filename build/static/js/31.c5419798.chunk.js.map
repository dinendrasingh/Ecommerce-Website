{"version":3,"sources":["components/forms/ProductUpdateForm.js","pages/admin/product/ProductUpdate.js","functions/category.js","components/nav/AdminNav.js","functions/product.js","components/forms/FileUpload.js"],"names":["Option","Select","ProductUpdateForm","handleSubmit","handleChange","values","setValues","handleCatagoryChange","categories","subOptions","arrayOfSubs","setArrayOfSubs","selectedCategory","title","description","price","category","shipping","subs","quantity","colors","images","brands","color","brand","onSubmit","className","type","name","value","onChange","map","c","b","_id","length","mode","style","width","placeholder","s","initialState","ProductUpdate","match","history","useState","setCategories","setSubOptions","setSelectedCategory","loading","setLoading","user","useSelector","state","slug","params","useEffect","loadProduct","loadCategories","getProduct","then","p","data","getCategorySubs","res","arr","push","console","log","prev","getCategories","AdminNav","LoadingOutlined","FileUpload","e","preventDefault","updateProduct","token","toast","success","catch","err","error","response","target","handleCategoryChange","a","axios","get","process","getCategory","removeCategory","authtoken","delete","headers","updateCategory","put","createCategory","post","to","createProduct","product","getProductsByCount","count","removeProduct","getProducts","sort","order","page","getProductsCount","productStar","productId","star","getRelated","fetchProductsByFilter","arg","image","onClick","public_id","filteredImages","filter","item","cursor","src","url","size","shape","multiple","hidden","accept","files","allUploadedFiles","i","Resizer","imageFileResizer","uri"],"mappings":"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","file":"static/js/31.c5419798.chunk.js","sourcesContent":["import React from \"react\";\r\nimport { Select } from \"antd\";\r\n\r\nconst { Option } = Select;\r\n\r\nconst ProductUpdateForm = ({\r\n  handleSubmit,\r\n  handleChange,\r\n  setValues,\r\n  values,\r\n  handleCatagoryChange,\r\n  categories,\r\n  subOptions,\r\n  arrayOfSubs,\r\n  setArrayOfSubs,\r\n  selectedCategory,\r\n}) => {\r\n  // destructure\r\n  const {\r\n    title,\r\n    description,\r\n    price,\r\n    category,\r\n    subs,\r\n    shipping,\r\n    quantity,\r\n    images,\r\n    colors,\r\n    brands,\r\n    color,\r\n    brand,\r\n  } = values;\r\n\r\n  return (\r\n    <form onSubmit={handleSubmit}>\r\n      <div className=\"form-group\">\r\n        <label>Title</label>\r\n        <input\r\n          type=\"text\"\r\n          name=\"title\"\r\n          className=\"form-control\"\r\n          value={title}\r\n          onChange={handleChange}\r\n        />\r\n      </div>\r\n\r\n      <div className=\"form-group\">\r\n        <label>Description</label>\r\n        <input\r\n          type=\"text\"\r\n          name=\"description\"\r\n          className=\"form-control\"\r\n          value={description}\r\n          onChange={handleChange}\r\n        />\r\n      </div>\r\n\r\n      <div className=\"form-group\">\r\n        <label>Price</label>\r\n        <input\r\n          type=\"number\"\r\n          name=\"price\"\r\n          className=\"form-control\"\r\n          value={price}\r\n          onChange={handleChange}\r\n        />\r\n      </div>\r\n\r\n      <div className=\"form-group\">\r\n        <label>Shipping</label>\r\n        <select\r\n          value={shipping === \"Yes\" ? \"Yes\" : \"No\"}\r\n          name=\"shipping\"\r\n          className=\"form-control\"\r\n          onChange={handleChange}\r\n        >\r\n          <option value=\"No\">No</option>\r\n          <option value=\"Yes\">Yes</option>\r\n        </select>\r\n      </div>\r\n\r\n      <div className=\"form-group\">\r\n        <label>Quantity</label>\r\n        <input\r\n          type=\"number\"\r\n          name=\"quantity\"\r\n          className=\"form-control\"\r\n          value={quantity}\r\n          onChange={handleChange}\r\n        />\r\n      </div>\r\n\r\n      <div className=\"form-group\">\r\n        <label>Color</label>\r\n        <select\r\n          value={color}\r\n          name=\"color\"\r\n          className=\"form-control\"\r\n          onChange={handleChange}\r\n        >\r\n          {colors.map((c) => (\r\n            <option key={c} value={c}>\r\n              {c}\r\n            </option>\r\n          ))}\r\n        </select>\r\n      </div>\r\n\r\n      <div className=\"form-group\">\r\n        <label>Brand</label>\r\n        <select\r\n          value={brand}\r\n          name=\"brand\"\r\n          className=\"form-control\"\r\n          onChange={handleChange}\r\n        >\r\n          {brands.map((b) => (\r\n            <option key={b} value={b}>\r\n              {b}\r\n            </option>\r\n          ))}\r\n        </select>\r\n      </div>\r\n\r\n      <div className=\"form-group\">\r\n        <label>Category</label>\r\n        <select\r\n          name=\"category\"\r\n          className=\"form-control\"\r\n          onChange={handleCatagoryChange}\r\n          value={selectedCategory ? selectedCategory : category._id}\r\n        >\r\n          {categories.length > 0 &&\r\n            categories.map((c) => (\r\n              <option key={c._id} value={c._id}>\r\n                {c.name}\r\n              </option>\r\n            ))}\r\n        </select>\r\n      </div>\r\n\r\n      <div>\r\n        <label>Sub Categories</label>\r\n        <Select\r\n          mode=\"multiple\"\r\n          style={{ width: \"100%\" }}\r\n          placeholder=\"Please select\"\r\n          value={arrayOfSubs}\r\n          onChange={(value) => setArrayOfSubs(value)}\r\n        >\r\n          {subOptions.length &&\r\n            subOptions.map((s) => (\r\n              <Option key={s._id} value={s._id}>\r\n                {s.name}\r\n              </Option>\r\n            ))}\r\n        </Select>\r\n      </div>\r\n\r\n      <br />\r\n      <button className=\"btn btn-outline-info\">Save</button>\r\n    </form>\r\n  );\r\n};\r\n\r\nexport default ProductUpdateForm;\r\n","import React, { useState, useEffect } from \"react\";\r\nimport AdminNav from \"../../../components/nav/AdminNav\";\r\nimport { toast } from \"react-toastify\";\r\nimport { useSelector } from \"react-redux\";\r\nimport { getProduct, updateProduct } from \"../../../functions/product\";\r\nimport { getCategories, getCategorySubs } from \"../../../functions/category\";\r\nimport FileUpload from \"../../../components/forms/FileUpload\";\r\nimport { LoadingOutlined } from \"@ant-design/icons\";\r\nimport ProductUpdateForm from \"../../../components/forms/ProductUpdateForm\";\r\n\r\nconst initialState = {\r\n  title: \"\",\r\n  description: \"\",\r\n  price: \"\",\r\n  category: \"\",\r\n  subs: [],\r\n  shipping: \"\",\r\n  quantity: \"\",\r\n  images: [],\r\n  colors: [\"Black\", \"Brown\", \"Silver\", \"White\", \"Blue\"],\r\n  brands: [\"Apple\", \"Samsung\", \"Microsoft\", \"Lenovo\", \"ASUS\"],\r\n  color: \"\",\r\n  brand: \"\",\r\n};\r\n\r\nconst ProductUpdate = ({ match, history }) => {\r\n  // state\r\n  const [values, setValues] = useState(initialState);\r\n  const [categories, setCategories] = useState([]);\r\n  const [subOptions, setSubOptions] = useState([]);\r\n  const [arrayOfSubs, setArrayOfSubs] = useState([]);\r\n  const [selectedCategory, setSelectedCategory] = useState(\"\");\r\n  const [loading, setLoading] = useState(false);\r\n\r\n  const { user } = useSelector((state) => ({ ...state }));\r\n  // router\r\n  const { slug } = match.params;\r\n\r\n  useEffect(() => {\r\n    loadProduct();\r\n    loadCategories();\r\n  }, []);\r\n\r\n  const loadProduct = () => {\r\n    getProduct(slug).then((p) => {\r\n      // console.log(\"single product\", p);\r\n      // 1 load single proudct\r\n      setValues({ ...values, ...p.data });\r\n      // 2 load single product category subs\r\n      getCategorySubs(p.data.category._id).then((res) => {\r\n        setSubOptions(res.data); // on first load, show default subs\r\n      });\r\n      // 3 prepare array of sub ids to show as default sub values in antd Select\r\n      let arr = [];\r\n      p.data.subs.map((s) => {\r\n        arr.push(s._id);\r\n      });\r\n      console.log(\"ARR\", arr);\r\n      setArrayOfSubs((prev) => arr); // required for ant design select to work\r\n    });\r\n  };\r\n\r\n  const loadCategories = () =>\r\n    getCategories().then((c) => {\r\n      console.log(\"GET CATEGORIES IN UPDATE PRODUCT\", c.data);\r\n      setCategories(c.data);\r\n    });\r\n\r\n  const handleSubmit = (e) => {\r\n    e.preventDefault();\r\n    setLoading(true);\r\n\r\n    values.subs = arrayOfSubs;\r\n    values.category = selectedCategory ? selectedCategory : values.category;\r\n\r\n    updateProduct(slug, values, user.token)\r\n      .then((res) => {\r\n        setLoading(false);\r\n        toast.success(`\"${res.data.title}\" is updated`);\r\n        history.push(\"/admin/products\");\r\n      })\r\n      .catch((err) => {\r\n        console.log(err);\r\n        setLoading(false);\r\n        toast.error(err.response.data.err);\r\n      });\r\n  };\r\n\r\n  const handleChange = (e) => {\r\n    setValues({ ...values, [e.target.name]: e.target.value });\r\n    // console.log(e.target.name, \" ----- \", e.target.value);\r\n  };\r\n\r\n  const handleCategoryChange = (e) => {\r\n    e.preventDefault();\r\n    console.log(\"CLICKED CATEGORY\", e.target.value);\r\n    setValues({ ...values, subs: [] });\r\n\r\n    setSelectedCategory(e.target.value);\r\n\r\n    getCategorySubs(e.target.value).then((res) => {\r\n      console.log(\"SUB OPTIONS ON CATGORY CLICK\", res);\r\n      setSubOptions(res.data);\r\n    });\r\n\r\n    console.log(\"EXISTING CATEGORY values.category\", values.category);\r\n\r\n    // if user clicks back to the original category\r\n    // show its sub categories in default\r\n    if (values.category._id === e.target.value) {\r\n      loadProduct();\r\n    }\r\n    // clear old sub category ids\r\n    setArrayOfSubs([]);\r\n  };\r\n\r\n  return (\r\n    <div className=\"container-fluid\">\r\n      <div className=\"row\">\r\n        <div className=\"col-md-2\">\r\n          <AdminNav />\r\n        </div>\r\n\r\n        <div className=\"col-md-10\">\r\n          {loading ? (\r\n            <LoadingOutlined className=\"text-danger h1\" />\r\n          ) : (\r\n            <h4>Product update</h4>\r\n          )}\r\n\r\n          {/* {JSON.stringify(values)} */}\r\n\r\n          <div className=\"p-3\">\r\n            <FileUpload\r\n              values={values}\r\n              setValues={setValues}\r\n              setLoading={setLoading}\r\n            />\r\n          </div>\r\n\r\n          <ProductUpdateForm\r\n            handleSubmit={handleSubmit}\r\n            handleChange={handleChange}\r\n            setValues={setValues}\r\n            values={values}\r\n            handleCategoryChange={handleCategoryChange}\r\n            categories={categories}\r\n            subOptions={subOptions}\r\n            arrayOfSubs={arrayOfSubs}\r\n            setArrayOfSubs={setArrayOfSubs}\r\n            selectedCategory={selectedCategory}\r\n          />\r\n          <hr />\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ProductUpdate;\r\n","import axios from \"axios\";\r\n\r\nexport const getCategories = async () =>\r\n  await axios.get(`${process.env.REACT_APP_API}/categories`);\r\n\r\nexport const getCategory = async (slug) =>\r\n  await axios.get(`${process.env.REACT_APP_API}/category/${slug}`);\r\n\r\nexport const removeCategory = async (slug, authtoken) =>\r\n  await axios.delete(`${process.env.REACT_APP_API}/category/${slug}`, {\r\n    headers: {\r\n      authtoken,\r\n    },\r\n  });\r\n\r\nexport const updateCategory = async (slug, category, authtoken) =>\r\n  await axios.put(`${process.env.REACT_APP_API}/category/${slug}`, category, {\r\n    headers: {\r\n      authtoken,\r\n    },\r\n  });\r\n\r\nexport const createCategory = async (category, authtoken) =>\r\n  await axios.post(`${process.env.REACT_APP_API}/category`, category, {\r\n    headers: {\r\n      authtoken,\r\n    },\r\n  });\r\n\r\nexport const getCategorySubs = async (_id) =>\r\n  await axios.get(`${process.env.REACT_APP_API}/category/subs/${_id}`);\r\n","import React from \"react\";\r\nimport { Link } from \"react-router-dom\";\r\n\r\nconst AdminNav = () => (\r\n  <nav>\r\n    <ul className=\"nav flex-column\">\r\n      <li className=\"nav-item\">\r\n        <Link to=\"/admin/dashboard\" className=\"nav-link\">\r\n          Dashboard\r\n        </Link>\r\n      </li>\r\n\r\n      <li className=\"nav-item\">\r\n        <Link to=\"/admin/product\" className=\"nav-link\">\r\n          Product\r\n        </Link>\r\n      </li>\r\n\r\n      <li className=\"nav-item\">\r\n        <Link to=\"/admin/products\" className=\"nav-link\">\r\n          Products\r\n        </Link>\r\n      </li>\r\n\r\n      <li className=\"nav-item\">\r\n        <Link to=\"/admin/category\" className=\"nav-link\">\r\n          Category\r\n        </Link>\r\n      </li>\r\n\r\n      <li className=\"nav-item\">\r\n        <Link to=\"/admin/sub\" className=\"nav-link\">\r\n          Sub Category\r\n        </Link>\r\n      </li>\r\n\r\n      <li className=\"nav-item\">\r\n        <Link to=\"/admin/coupon\" className=\"nav-link\">\r\n          Coupon\r\n        </Link>\r\n      </li>\r\n\r\n      <li className=\"nav-item\">\r\n        <Link to=\"/user/password\" className=\"nav-link\">\r\n          Password\r\n        </Link>\r\n      </li>\r\n    </ul>\r\n  </nav>\r\n);\r\n\r\nexport default AdminNav;\r\n","import axios from \"axios\";\r\n\r\nexport const createProduct = async (product, authtoken) =>\r\n  await axios.post(`${process.env.REACT_APP_API}/product`, product, {\r\n    headers: {\r\n      authtoken,\r\n    },\r\n  });\r\n\r\nexport const getProductsByCount = async (count) =>\r\n  await axios.get(`${process.env.REACT_APP_API}/products/${count}`);\r\n\r\nexport const removeProduct = async (slug, authtoken) =>\r\n  await axios.delete(`${process.env.REACT_APP_API}/product/${slug}`, {\r\n    headers: {\r\n      authtoken,\r\n    },\r\n  });\r\n\r\nexport const getProduct = async (slug) =>\r\n  await axios.get(`${process.env.REACT_APP_API}/product/${slug}`);\r\n\r\nexport const updateProduct = async (slug, product, authtoken) =>\r\n  await axios.put(`${process.env.REACT_APP_API}/product/${slug}`, product, {\r\n    headers: {\r\n      authtoken,\r\n    },\r\n  });\r\n\r\nexport const getProducts = async (sort, order, page) =>\r\n  await axios.post(`${process.env.REACT_APP_API}/products`, {\r\n    sort,\r\n    order,\r\n    page,\r\n  });\r\n\r\nexport const getProductsCount = async () =>\r\n  await axios.get(`${process.env.REACT_APP_API}/products/total`);\r\n\r\nexport const productStar = async (productId, star, authtoken) =>\r\n  await axios.put(\r\n    `${process.env.REACT_APP_API}/product/star/${productId}`,\r\n    { star },\r\n    {\r\n      headers: {\r\n        authtoken,\r\n      },\r\n    }\r\n  );\r\n\r\nexport const getRelated = async (productId) =>\r\n  await axios.get(`${process.env.REACT_APP_API}/product/related/${productId}`);\r\n\r\nexport const fetchProductsByFilter = async (arg) =>\r\n  await axios.post(`${process.env.REACT_APP_API}/search/filters`, arg);\r\n","import React from \"react\";\r\nimport Resizer from \"react-image-file-resizer\";\r\nimport axios from \"axios\";\r\nimport { useSelector } from \"react-redux\";\r\nimport { Avatar, Badge } from \"antd\";\r\n\r\nconst FileUpload = ({ values, setValues, setLoading }) => {\r\n  const { user } = useSelector((state) => ({ ...state }));\r\n\r\n  const fileUploadAndResize = (e) => {\r\n    // console.log(e.target.files);\r\n    // resize\r\n    let files = e.target.files; // 3\r\n    let allUploadedFiles = values.images;\r\n\r\n    if (files) {\r\n      setLoading(true);\r\n      for (let i = 0; i < files.length; i++) {\r\n        Resizer.imageFileResizer(\r\n          files[i],\r\n          720,\r\n          720,\r\n          \"JPEG\",\r\n          100,\r\n          0,\r\n          (uri) => {\r\n            // console.log(uri);\r\n            axios\r\n              .post(\r\n                `${process.env.REACT_APP_API}/uploadimages`,\r\n                { image: uri },\r\n                {\r\n                  headers: {\r\n                    authtoken: user ? user.token : \"\",\r\n                  },\r\n                }\r\n              )\r\n              .then((res) => {\r\n                console.log(\"IMAGE UPLOAD RES DATA\", res);\r\n                setLoading(false);\r\n                allUploadedFiles.push(res.data);\r\n\r\n                setValues({ ...values, images: allUploadedFiles });\r\n              })\r\n              .catch((err) => {\r\n                setLoading(false);\r\n                console.log(\"CLOUDINARY UPLOAD ERR\", err);\r\n              });\r\n          },\r\n          \"base64\"\r\n        );\r\n      }\r\n    }\r\n    // send back to server to upload to cloudinary\r\n    // set url to images[] in the parent component state - ProductCreate\r\n  };\r\n\r\n  const handleImageRemove = (public_id) => {\r\n    setLoading(true);\r\n    // console.log(\"remove image\", public_id);\r\n    axios\r\n      .post(\r\n        `${process.env.REACT_APP_API}/removeimage`,\r\n        { public_id },\r\n        {\r\n          headers: {\r\n            authtoken: user ? user.token : \"\",\r\n          },\r\n        }\r\n      )\r\n      .then((res) => {\r\n        setLoading(false);\r\n        const { images } = values;\r\n        let filteredImages = images.filter((item) => {\r\n          return item.public_id !== public_id;\r\n        });\r\n        setValues({ ...values, images: filteredImages });\r\n      })\r\n      .catch((err) => {\r\n        console.log(err);\r\n        setLoading(false);\r\n      });\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <div className=\"row\">\r\n        {values.images &&\r\n          values.images.map((image) => (\r\n            <Badge\r\n              count=\"X\"\r\n              key={image.public_id}\r\n              onClick={() => handleImageRemove(image.public_id)}\r\n              style={{ cursor: \"pointer\" }}\r\n            >\r\n              <Avatar\r\n                src={image.url}\r\n                size={100}\r\n                shape=\"square\"\r\n                className=\"ml-3\"\r\n              />\r\n            </Badge>\r\n          ))}\r\n      </div>\r\n      <div className=\"row\">\r\n        <label className=\"btn btn-primary btn-raised mt-3\">\r\n          Choose File\r\n          <input\r\n            type=\"file\"\r\n            multiple\r\n            hidden\r\n            accept=\"images/*\"\r\n            onChange={fileUploadAndResize}\r\n          />\r\n        </label>\r\n      </div>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default FileUpload;\r\n"],"sourceRoot":""}